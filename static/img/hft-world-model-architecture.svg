<svg viewBox="0 0 900 620" xmlns="http://www.w3.org/2000/svg" font-family="system-ui, -apple-system, sans-serif">
  <!-- Background -->
  <rect width="900" height="620" fill="#f8fafc" rx="12"/>
  <text x="450" y="36" text-anchor="middle" font-size="18" font-weight="700" fill="#1e293b">HFT World Model — System Architecture</text>
  <text x="450" y="56" text-anchor="middle" font-size="12" fill="#64748b">Tick Data · Latent State · Sub-millisecond Signal Generation</text>

  <defs>
    <marker id="arrowBlue" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#3b82f6"/>
    </marker>
    <marker id="arrowRed" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#ef4444"/>
    </marker>
    <marker id="arrowGreen" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#22c55e"/>
    </marker>
    <marker id="arrowAmber" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#f59e0b"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#8b5cf6"/>
    </marker>
  </defs>

  <!-- Layer 1: Market Data Feed -->
  <rect x="30" y="80" width="840" height="70" rx="10" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.8"/>
  <text x="450" y="108" text-anchor="middle" font-size="13" font-weight="700" fill="#1d4ed8">Market Data Feed Layer</text>
  <text x="150" y="130" text-anchor="middle" font-size="11" fill="#1e40af">Exchange Feed (ITCH/OUCH)</text>
  <text x="350" y="130" text-anchor="middle" font-size="11" fill="#1e40af">Order Book L2/L3</text>
  <text x="550" y="130" text-anchor="middle" font-size="11" fill="#1e40af">Trade Tape</text>
  <text x="750" y="130" text-anchor="middle" font-size="11" fill="#1e40af">News Wire (NLP)</text>

  <!-- Arrow down -->
  <line x1="450" y1="150" x2="450" y2="178" stroke="#3b82f6" stroke-width="1.8" marker-end="url(#arrowBlue)"/>

  <!-- Layer 2: Feature Extraction -->
  <rect x="30" y="180" width="840" height="80" rx="10" fill="#ede9fe" stroke="#8b5cf6" stroke-width="1.8"/>
  <text x="450" y="205" text-anchor="middle" font-size="13" font-weight="700" fill="#5b21b6">Microstructure Feature Extraction  (&lt;10 µs)</text>
  <rect x="50" y="215" width="155" height="32" rx="6" fill="#f5f3ff" stroke="#8b5cf6" stroke-width="1.2"/>
  <text x="127" y="235" text-anchor="middle" font-size="10" fill="#5b21b6">Order-Flow Imbalance</text>
  <rect x="220" y="215" width="155" height="32" rx="6" fill="#f5f3ff" stroke="#8b5cf6" stroke-width="1.2"/>
  <text x="297" y="235" text-anchor="middle" font-size="10" fill="#5b21b6">Queue Position Depth</text>
  <rect x="390" y="215" width="155" height="32" rx="6" fill="#f5f3ff" stroke="#8b5cf6" stroke-width="1.2"/>
  <text x="467" y="235" text-anchor="middle" font-size="10" fill="#5b21b6">Bid-Ask Spread EWMA</text>
  <rect x="560" y="215" width="155" height="32" rx="6" fill="#f5f3ff" stroke="#8b5cf6" stroke-width="1.2"/>
  <text x="637" y="235" text-anchor="middle" font-size="10" fill="#5b21b6">Trade Arrival Rate</text>
  <rect x="730" y="215" width="125" height="32" rx="6" fill="#f5f3ff" stroke="#8b5cf6" stroke-width="1.2"/>
  <text x="792" y="235" text-anchor="middle" font-size="10" fill="#5b21b6">Toxicity (VPIN)</text>

  <!-- Arrow down -->
  <line x1="450" y1="260" x2="450" y2="288" stroke="#8b5cf6" stroke-width="1.8" marker-end="url(#arrowPurple)"/>

  <!-- Layer 3: World Model Core -->
  <rect x="30" y="290" width="840" height="90" rx="10" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="450" y="315" text-anchor="middle" font-size="14" font-weight="700" fill="#92400e">World Model Core — VMC Architecture</text>
  <!-- Vision -->
  <rect x="60" y="325" width="190" height="40" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="155" y="340" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">Vision (Encoder)</text>
  <text x="155" y="356" text-anchor="middle" font-size="10" fill="#b45309">Obs → Latent State z_t</text>
  <!-- Memory -->
  <rect x="355" y="325" width="190" height="40" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="450" y="340" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">Memory (Dynamics)</text>
  <text x="450" y="356" text-anchor="middle" font-size="10" fill="#b45309">z_t → z_{t+1} prediction</text>
  <!-- Controller -->
  <rect x="650" y="325" width="190" height="40" rx="8" fill="#fffbeb" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="745" y="340" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">Controller</text>
  <text x="745" y="356" text-anchor="middle" font-size="10" fill="#b45309">z_t → Action policy</text>
  <!-- Arrows between VMC -->
  <line x1="250" y1="345" x2="353" y2="345" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrowAmber)"/>
  <line x1="545" y1="345" x2="648" y2="345" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrowAmber)"/>

  <!-- Arrow down -->
  <line x1="450" y1="380" x2="450" y2="408" stroke="#f59e0b" stroke-width="1.8" marker-end="url(#arrowAmber)"/>

  <!-- Layer 4: Signal Generation -->
  <rect x="30" y="410" width="400" height="80" rx="10" fill="#dcfce7" stroke="#22c55e" stroke-width="1.8"/>
  <text x="230" y="435" text-anchor="middle" font-size="13" font-weight="700" fill="#15803d">Signal Generation (&lt;100 µs)</text>
  <text x="230" y="455" text-anchor="middle" font-size="11" fill="#166534">Alpha signal · Direction · Magnitude</text>
  <text x="230" y="473" text-anchor="middle" font-size="10" fill="#22c55e">Confidence band · Horizon (µs → ms)</text>

  <!-- Layer 4: Risk Filter -->
  <rect x="470" y="410" width="400" height="80" rx="10" fill="#fee2e2" stroke="#ef4444" stroke-width="1.8"/>
  <text x="670" y="435" text-anchor="middle" font-size="13" font-weight="700" fill="#b91c1c">Pre-trade Risk Filter</text>
  <text x="670" y="455" text-anchor="middle" font-size="11" fill="#991b1b">Position limits · Fat-finger checks</text>
  <text x="670" y="473" text-anchor="middle" font-size="10" fill="#ef4444">Kill switch · Exposure caps · Velocity</text>

  <!-- Arrow between signal and risk -->
  <line x1="430" y1="450" x2="468" y2="450" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowBlue)"/>

  <!-- Arrow down -->
  <line x1="450" y1="490" x2="450" y2="518" stroke="#22c55e" stroke-width="1.8" marker-end="url(#arrowGreen)"/>

  <!-- Layer 5: Order Execution -->
  <rect x="30" y="520" width="840" height="70" rx="10" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="450" y="545" text-anchor="middle" font-size="13" font-weight="700" fill="#15803d">Smart Order Router / Co-located OMS</text>
  <text x="180" y="568" text-anchor="middle" font-size="10" fill="#166534">Exchange A (Primary)</text>
  <text x="370" y="568" text-anchor="middle" font-size="10" fill="#166534">Exchange B (Alt venue)</text>
  <text x="560" y="568" text-anchor="middle" font-size="10" fill="#166534">Dark Pool</text>
  <text x="740" y="568" text-anchor="middle" font-size="10" fill="#166534">Market Maker quote</text>

  <!-- Latency label -->
  <rect x="760" y="390" width="120" height="36" rx="6" fill="#fef9c3" stroke="#ca8a04" stroke-width="1.2"/>
  <text x="820" y="406" text-anchor="middle" font-size="10" font-weight="700" fill="#854d0e">End-to-end</text>
  <text x="820" y="420" text-anchor="middle" font-size="11" font-weight="700" fill="#dc2626">&lt; 500 µs</text>
</svg>
