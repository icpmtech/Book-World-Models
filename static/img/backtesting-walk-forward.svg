<svg viewBox="0 0 900 520" xmlns="http://www.w3.org/2000/svg" font-family="system-ui, -apple-system, sans-serif">
  <!-- Background -->
  <rect width="900" height="520" fill="#f8fafc" rx="12"/>
  <text x="450" y="36" text-anchor="middle" font-size="18" font-weight="700" fill="#1e293b">Backtesting Framework — Walk-Forward Validation</text>
  <text x="450" y="56" text-anchor="middle" font-size="12" fill="#64748b">Event-Conditioned Backtesting · Performance Metrics · Look-Ahead Prevention</text>

  <defs>
    <marker id="arrowBT" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#475569"/>
    </marker>
    <marker id="arrowGreenBT" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#16a34a"/>
    </marker>
    <marker id="arrowBlueBT" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#2563eb"/>
    </marker>
    <marker id="arrowRedBT" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <path d="M0,0 L0,6 L8,3 z" fill="#dc2626"/>
    </marker>
  </defs>

  <!-- Walk-Forward timeline (top) -->
  <rect x="20" y="75" width="860" height="100" rx="10" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="450" y="96" text-anchor="middle" font-size="12" font-weight="600" fill="#334155">Walk-Forward Validation — No Look-Ahead</text>

  <!-- Training / test windows -->
  <!-- Window 1 -->
  <rect x="40" y="106" width="160" height="28" rx="5" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1"/>
  <text x="120" y="125" text-anchor="middle" font-size="10" fill="#1e40af">Train W1</text>
  <rect x="205" y="106" width="50" height="28" rx="5" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="230" y="125" text-anchor="middle" font-size="10" fill="#15803d">Test 1</text>

  <!-- Window 2 -->
  <rect x="40" y="140" width="210" height="18" rx="5" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1" opacity="0.7"/>
  <text x="145" y="153" text-anchor="middle" font-size="9" fill="#1e40af">Train W2 (expanded)</text>
  <rect x="255" y="140" width="50" height="18" rx="5" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="280" y="153" text-anchor="middle" font-size="9" fill="#15803d">Test 2</text>

  <!-- Window 3 -->
  <rect x="40" y="162" width="260" height="10" rx="3" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1" opacity="0.5"/>
  <rect x="305" y="162" width="50" height="10" rx="3" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>

  <!-- Continuation dots -->
  <text x="400" y="165" text-anchor="middle" font-size="14" fill="#64748b">· · ·</text>

  <!-- Last window (production zone) -->
  <rect x="450" y="106" width="350" height="28" rx="5" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1"/>
  <text x="625" y="125" text-anchor="middle" font-size="10" fill="#1e40af">Final Train Window</text>
  <rect x="805" y="106" width="60" height="28" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="835" y="125" text-anchor="middle" font-size="10" font-weight="600" fill="#92400e">OOS</text>

  <!-- Metrics grid (left side) -->
  <rect x="20" y="200" width="380" height="290" rx="10" fill="#fff" stroke="#e2e8f0" stroke-width="1.5"/>
  <text x="210" y="223" text-anchor="middle" font-size="13" font-weight="600" fill="#1e293b">Performance Metrics</text>

  <!-- Metric rows -->
  <!-- Sharpe -->
  <rect x="35" y="234" width="130" height="34" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
  <text x="100" y="252" text-anchor="middle" font-size="11" font-weight="600" fill="#1d4ed8">Annualised Sharpe</text>
  <text x="100" y="263" text-anchor="middle" font-size="9" fill="#2563eb">excess_return / ann_vol</text>
  <text x="285" y="255" text-anchor="start" font-size="12" font-weight="700" fill="#22c55e">1.83</text>
  <text x="330" y="255" text-anchor="start" font-size="10" fill="#64748b">example</text>

  <!-- Max Drawdown -->
  <rect x="35" y="276" width="130" height="34" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/>
  <text x="100" y="294" text-anchor="middle" font-size="11" font-weight="600" fill="#b91c1c">Max Drawdown</text>
  <text x="100" y="305" text-anchor="middle" font-size="9" fill="#dc2626">peak → trough equity</text>
  <text x="285" y="297" text-anchor="start" font-size="12" font-weight="700" fill="#ef4444">−14.2%</text>

  <!-- Calmar -->
  <rect x="35" y="318" width="130" height="34" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <text x="100" y="336" text-anchor="middle" font-size="11" font-weight="600" fill="#92400e">Calmar Ratio</text>
  <text x="100" y="347" text-anchor="middle" font-size="9" fill="#b45309">ann_return / max_drawdown</text>
  <text x="285" y="339" text-anchor="start" font-size="12" font-weight="700" fill="#f59e0b">2.41</text>

  <!-- Win Rate -->
  <rect x="35" y="360" width="130" height="34" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
  <text x="100" y="378" text-anchor="middle" font-size="11" font-weight="600" fill="#15803d">Win Rate</text>
  <text x="100" y="389" text-anchor="middle" font-size="9" fill="#166534">fraction positive days</text>
  <text x="285" y="381" text-anchor="start" font-size="12" font-weight="700" fill="#22c55e">57.3%</text>

  <!-- IC -->
  <rect x="35" y="402" width="130" height="34" rx="6" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/>
  <text x="100" y="420" text-anchor="middle" font-size="11" font-weight="600" fill="#5b21b6">IC</text>
  <text x="100" y="431" text-anchor="middle" font-size="9" fill="#6d28d9">Pearson(forecast, outcome)</text>
  <text x="285" y="423" text-anchor="start" font-size="12" font-weight="700" fill="#7c3aed">0.062</text>

  <!-- ICIR -->
  <rect x="35" y="444" width="130" height="34" rx="6" fill="#ede9fe" stroke="#7c3aed" stroke-width="1"/>
  <text x="100" y="462" text-anchor="middle" font-size="11" font-weight="600" fill="#5b21b6">ICIR</text>
  <text x="100" y="473" text-anchor="middle" font-size="9" fill="#6d28d9">IC / std(IC) consistency</text>
  <text x="285" y="465" text-anchor="start" font-size="12" font-weight="700" fill="#7c3aed">1.74</text>

  <!-- Event-Conditioned Backtest (right side) -->
  <rect x="430" y="200" width="450" height="290" rx="10" fill="#fff" stroke="#e2e8f0" stroke-width="1.5"/>
  <text x="655" y="223" text-anchor="middle" font-size="13" font-weight="600" fill="#1e293b">Event-Conditioned Return Stratification</text>

  <!-- Bar chart -->
  <!-- Axes -->
  <line x1="490" y1="440" x2="860" y2="440" stroke="#475569" stroke-width="1.3"/>
  <line x1="490" y1="440" x2="490" y2="240" stroke="#475569" stroke-width="1.3"/>
  <text x="480" y="444" text-anchor="end" font-size="9" fill="#64748b">0%</text>
  <text x="480" y="400" text-anchor="end" font-size="9" fill="#64748b">0.5%</text>
  <text x="480" y="360" text-anchor="end" font-size="9" fill="#64748b">1.0%</text>
  <text x="480" y="320" text-anchor="end" font-size="9" fill="#64748b">1.5%</text>
  <text x="480" y="280" text-anchor="end" font-size="9" fill="#64748b">2.0%</text>
  <line x1="490" y1="400" x2="860" y2="400" stroke="#e2e8f0" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="490" y1="360" x2="860" y2="360" stroke="#e2e8f0" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="490" y1="320" x2="860" y2="320" stroke="#e2e8f0" stroke-width="0.8" stroke-dasharray="3,2"/>
  <line x1="490" y1="280" x2="860" y2="280" stroke="#e2e8f0" stroke-width="0.8" stroke-dasharray="3,2"/>

  <!-- Pre-event bar -->
  <rect x="520" y="380" width="60" height="60" fill="#fca5a5" stroke="#ef4444" stroke-width="1" rx="3"/>
  <text x="550" y="455" text-anchor="middle" font-size="10" fill="#1e293b">Pre-event</text>
  <text x="550" y="375" text-anchor="middle" font-size="10" font-weight="600" fill="#dc2626">+0.75%</text>

  <!-- Event-day bar -->
  <rect x="620" y="320" width="60" height="120" fill="#fca5a5" stroke="#b91c1c" stroke-width="1.5" rx="3"/>
  <text x="650" y="455" text-anchor="middle" font-size="10" fill="#1e293b">Event Day</text>
  <text x="650" y="315" text-anchor="middle" font-size="10" font-weight="700" fill="#b91c1c">+1.50%</text>

  <!-- Post-event bar -->
  <rect x="720" y="355" width="60" height="85" fill="#86efac" stroke="#22c55e" stroke-width="1.5" rx="3"/>
  <text x="750" y="455" text-anchor="middle" font-size="10" fill="#1e293b">Post-event</text>
  <text x="750" y="350" text-anchor="middle" font-size="10" font-weight="600" fill="#15803d">+1.06%</text>

  <!-- Neutral bar -->
  <rect x="810" y="416" width="40" height="24" fill="#bfdbfe" stroke="#3b82f6" stroke-width="1" rx="3"/>
  <text x="830" y="455" text-anchor="middle" font-size="10" fill="#1e293b">Neutral</text>
  <text x="830" y="412" text-anchor="middle" font-size="10" fill="#1d4ed8">+0.30%</text>

  <text x="655" y="475" text-anchor="middle" font-size="10" fill="#64748b" font-style="italic">Mean daily return by proximity to high-impact events</text>

  <!-- Look-Ahead Prevention note -->
  <rect x="430" y="490" width="450" height="16" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <text x="655" y="503" text-anchor="middle" font-size="10" fill="#92400e">⚠ Look-ahead prevention: future data strictly excluded from each training window</text>
</svg>
